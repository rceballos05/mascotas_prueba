@using ChartJs.Blazor.PieChart


<Chart Config="config" @ref="chart"></Chart>

@code {
    private PieConfig config;
    private Chart chart = new Chart();

    protected override void OnInitialized()
    {
        RealizarConfiguracionGrafico();
    }

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender && chart != null)
        {
            try
            {
                await chart.Update();
            }
            catch (Exception ex)
            {
                Console.WriteLine($"Error updating the chart: {ex.Message}");
            }
        }
    }


    private void RealizarConfiguracionGrafico()
    {
        config = new PieConfig()
            {
                Options = new PieOptions
                {
                    Responsive = true,
                    Title = new OptionsTitle
                    {
                        Display = true
                    }
                }
            };

        foreach (var item in new[] { "PRUEBA 1", "PRUEBA 2", "PRUEBA 3" })
        {
            config.Data.Labels.Add(item);
        }

        var dataset = new PieDataset<int>(new[] { 35, 50, 15 })
            {
                BackgroundColor = new[]
                {
                    ColorUtil.ColorHexString(255, 0, 0),
                    ColorUtil.ColorHexString(0, 255, 0),
                    ColorUtil.ColorHexString(0, 0, 255)
                }
            };

        config.Data.Datasets.Add(dataset);
    }
}
